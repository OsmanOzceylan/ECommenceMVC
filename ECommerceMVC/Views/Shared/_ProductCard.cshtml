@model ECommerceMVC.Core.Models.Response.ProductResponseModel
@{
    var favoriteIds = ViewData["FavoriteIds"] as List<int> ?? new List<int>();
}

<div class="col-sm-6 col-md-4 col-lg-3 mb-4">
    <div class="card h-100">
        <a asp-controller="Product" asp-action="Details" asp-route-productId="@Model.ProductID">
            <img src="@(Model.ImageUrl ?? "/images/default.png")"
                 class="card-img-top"
                 alt="@Model.ProductName"
                 style="height:200px; object-fit:cover;">
        </a>
        <div class="card-body d-flex flex-column">
            <h5 class="card-title">@Model.ProductName</h5>
            <p class="card-text">Kategori: @Model.CategoryName</p>
            <p class="card-text">Fiyat: @Model.UnitPrice.ToString("C")</p>

            <form asp-action="AddToCart" asp-controller="Product" method="post" class="mt-auto">
                <input type="hidden" name="productId" value="@Model.ProductID" />
                <input type="hidden" name="productName" value="@Model.ProductName" />
                <input type="hidden" name="unitPrice" value="@Model.UnitPrice" />
                <input type="hidden" name="imageUrl" value="@Model.ImageUrl" />
                <button type="submit" class="btn btn-success w-100">Sepete Ekle</button>
            </form>

            <form asp-action="ToggleFavorite" asp-controller="Favorite" method="post" class="mt-2">
                <input type="hidden" name="productId" value="@Model.ProductID" />
                <button type="submit"
                        class="btn @(favoriteIds.Contains(Model.ProductID) ? "btn-warning" : "btn-outline-danger") w-100">
                    @(favoriteIds.Contains(Model.ProductID) ? "Favoriden Çıkar" : "Favorilere Ekle")
                </button>
            </form>
        </div>
    </div>
</div>
